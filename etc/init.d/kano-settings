#!/bin/sh

### BEGIN INIT INFO
# Provides:         kano-settings
# Required-Start:   $local_fs
# Required-Stop:
# X-Start-Before:   lightdm
# Default-Start:    2
# Default-Stop:
### END INIT INFO

. /lib/lsb/init-functions

case "$1" in
    start)
        # Display a welcome message to the bootup terminal
        echo "Get ready... Kano is starting up." > /dev/tty1

	log_action_begin_msg "Running kano-settings-onboot"
	/usr/bin/kano-settings-onboot
        # Fix for noobs:
        setcap -v cap_net_raw+ep /bin/ping6 || true
        setcap -v cap_net_raw+ep /bin/ping || true
        setcap -v cap_net_raw+ep /usr/bin/fping6 || true
        setcap -v cap_net_raw+ep /usr/bin/fping || true
        setcap -v cap_dac_override,cap_sys_ptrace+ep /usr/bin/systemd-detect-virt || true
	log_action_end_msg $?
	;;
    stop)
	;;
    restart|reload|force-reload|status)
        echo "Error: argument '$1' not supported" >&2
        exit 3
	;;
    *)
      echo "Usage: kano-settings [start|stop]" >&2
      exit 3
      ;;
esac

